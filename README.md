# AptecoPSModules

The Apteco PowerShell Modules allow you to extend your current Apteco Marketing Stack with more customisation. For example here is fully featured Framework to create your own channels for Orbit and PeopleStage. Other modules in here are helpful in working with your data.

All modules are targeted to be published on [PowerShell Gallery](https://www.powershellgallery.com/packages?q=apteco). So Installation is much easier than copy&paste.

Those are the already published packages, but more are in the pipeline:

Name|Type|Repository/Version|Platform|Downloads|
-|-|-|-|-
[AptecoPSFramework](AptecoPSFramework/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/AptecoPSFramework)](https://www.powershellgallery.com/packages/AptecoPSFramework)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/AptecoPSFramework)](https://www.powershellgallery.com/packages/AptecoPSFramework)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/AptecoPSFramework)](https://www.powershellgallery.com/packages/AptecoPSFramework)
[ConvertStrings](ConvertStrings/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/ConvertStrings)](https://www.powershellgallery.com/packages/ConvertStrings)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/ConvertStrings)](https://www.powershellgallery.com/packages/ConvertStrings)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/ConvertStrings)](https://www.powershellgallery.com/packages/ConvertStrings)
[ConvertUnixTimestamp](ConverUnixTimestamp/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/ConvertUnixTimestamp)](https://www.powershellgallery.com/packages/ConvertUnixTimestamp)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/ConvertUnixTimestamp)](https://www.powershellgallery.com/packages/ConvertUnixTimestamp)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/ConvertUnixTimestamp)](https://www.powershellgallery.com/packages/ConvertUnixTimestamp)
[EncryptCredential](EncryptCredential/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/EncryptCredential)](https://www.powershellgallery.com/packages/EncryptCredential)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/EncryptCredential)](https://www.powershellgallery.com/packages/EncryptCredential)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/EncryptCredential)](https://www.powershellgallery.com/packages/EncryptCredential)
[ExtendFunction](ExtendFunction/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/ExtendFunction)](https://www.powershellgallery.com/packages/ExtendFunction)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/ExtendFunction)](https://www.powershellgallery.com/packages/ExtendFunction)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/ExtendFunction)](https://www.powershellgallery.com/packages/ExtendFunction)
[InvokeWebRequestUTF8](InvokeWebRequestUTF8/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/InvokeWebRequestUTF8)](https://www.powershellgallery.com/packages/InvokeWebRequestUTF8)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/InvokeWebRequestUTF8)](https://www.powershellgallery.com/packages/InvokeWebRequestUTF8)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/InvokeWebRequestUTF8)](https://www.powershellgallery.com/packages/InvokeWebRequestUTF8)
[MeasureRows](MeasureRows/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/MeasureRows)](https://www.powershellgallery.com/packages/MeasureRows)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/MeasureRows)](https://www.powershellgallery.com/packages/MeasureRows)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/MeasureRows)](https://www.powershellgallery.com/packages/MeasureRows)
[MergeHashtable](MergeHashtable/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/MergeHashtable)](https://www.powershellgallery.com/packages/MergeHashtable)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/MergeHashtable)](https://www.powershellgallery.com/packages/MergeHashtable)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/MergeHashtable)](https://www.powershellgallery.com/packages/MergeHashtable)
[MergePSCustomObject](MergePSCustomObject/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/MergePSCustomObject)](https://www.powershellgallery.com/packages/MergePSCustomObject)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/MergePSCustomObject)](https://www.powershellgallery.com/packages/MergePSCustomObject)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/MergePSCustomObject)](https://www.powershellgallery.com/packages/MergePSCustomObject)
[SyncExtractOptions](SyncExtractOptions/)|Script|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/SyncExtractOptions)](https://www.powershellgallery.com/packages/SyncExtractOptions)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/SyncExtractOptions)](https://www.powershellgallery.com/packages/SyncExtractOptions)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/SyncExtractOptions)](https://www.powershellgallery.com/packages/SyncExtractOptions)
[WriteLog](WriteLog/)|Module|[![PowerShell Gallery Version (including pre-releases)](https://img.shields.io/powershellgallery/v/WriteLog)](https://www.powershellgallery.com/packages/WriteLog)|[![PowerShell Gallery Platform Support](https://img.shields.io/powershellgallery/p/WriteLog)](https://www.powershellgallery.com/packages/WriteLog)|[![PowerShell Gallery](https://img.shields.io/powershellgallery/dt/WriteLog)](https://www.powershellgallery.com/packages/WriteLog)


Here are some high level descriptions. Please follow the links from the table or go into the subdirectories to get more detailed information.




## AptecoPSFramework

This framework is mainly created for installing and using custom channels in Apteco Orbit and PeopleStage. The channel implementations are written in PowerShell and already implemented as "Plugins" in this module. But there is a function implemented so you can refer to your own channels that are not getting overwritten if you update this module.

## ConvertStrings

Allow you to manipulate strings like converting the string encoding or replacing strings. Random strings and hashed strings are also included.

## MergePSCustomObject

This module merges two PSCustomObjects into one. It is able to handle nested structures like hashtables, arrays and PSCustomObjects. 


## ConvertUnixTimestamp

Converts a `[DateTime]` into a numeric unix timestamp as `[UInt64]` and vice versa.

To get a unix timestamp from a `[DateTime]::Now` or `(Get-Date)` just do it like in these examples

```PowerShell
Get-Unixtime
Get-Unixtime -InMilliseconds
Get-Unixtime -InMilliseconds -Timestamp ( Get-Date ).AddDays(-2)
```

To convert a timestamp back, just do it like here

```PowerShell
ConvertFrom-UnixTime -Unixtime 1591775090
ConvertFrom-UnixTime -Unixtime 1591775090 -ConvertToLocalTimezone
ConvertFrom-UnixTime -Unixtime 1591775146091 -InMilliseconds
( ConvertFrom-UnixTime -Unixtime $lastSession.timestamp ).ToString("yyyy-MM-ddTHH:mm:ssK")
```


## EncryptCredential

This module is used to double encrypt sensitive data like credentials, tokens etc. They cannot be stolen pretty easily as it uses SecureStrings.

Execute commands like

```PowerShell
"Hello World" | Convert-PlaintextToSecure
```

to get a string like

```
76492d1116743f0423413b16050a5345MgB8AEEAYQBmAEEAOABPAEEAYQBmAEYAKwBuAGQAegBxACsASQBRAGIAaQA0AEEAPQA9AHwANAAxAGEAYQBhADAAYwA3ADQAYwBiADkAYwAzADEAZgBkAGUAZQBkADQAOABhADIAMgA5AGUAMAAyADkANwBiADcAMQAyADgAOAAzADkAMwBiADAANAA0ADcAMwA3ADQANgAxADMAYwBmADQAZQAyADIAMwBkAGQAMQBhADUAMAA=
```

This string can be decrypted by calling

```PowerShell
"76492d1116743f0423413b16050a5345MgB8AEEAYQBmAEEAOABPAEEAYQBmAEYAKwBuAGQAegBxACsASQBRAGIAaQA0AEEAPQA9AHwANAAxAGEAYQBhADAAYwA3ADQAYwBiADkAYwAzADEAZgBkAGUAZQBkADQAOABhADIAMgA5AGUAMAAyADkANwBiADcAMQAyADgAOAAzADkAMwBiADAANAA0ADcAMwA3ADQANgAxADMAYwBmADQAZQAyADIAMwBkAGQAMQBhADUAMAA=" | Convert-SecureToPlaintext
```

and get back

```
Hello World
```


## ExtendFunction

This module can be used to extend existing functions/cmdlets with more scripting and possibly additional parameters like

```PowerShell
function Invoke-CoreWebRequest {
    
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)][string]$AdditionalString
    )
    DynamicParam { Get-BaseParameters "Invoke-WebRequest" }

    Process {
        Write-Host $AdditionalString
        $updatedParameters = Skip-UnallowedBaseParameters -Base "Invoke-WebRequest" -Parameters $PSBoundParameters
        Invoke-WebRequest @updatedParameters
    }

}
```

## InvokeWebRequestUTF8

Executes an `Invoke-WebRequst`, but converts the content afterwards into UTF8, if the correct encoding wasn't given back.

## MeasureRows

Just use

```PowerShell
Measure-Rows -Path "C:\Temp\Example.csv"
```

or

```PowerShell
"C:\Temp\Example.csv" | Measure-Rows -SkipFirstRow
```

or

```PowerShell
Measure-Rows -Path "C:\Temp\Example.csv" -Encoding UTF8
```

or even

```PowerShell
"C:\Users\Florian\Downloads\adressen.csv", "C:\Users\Florian\Downloads\italian.csv" | Measure-Rows -SkipFirstRow -Encoding ([System.Text.Encoding]::UTF8)
```

to count the rows in a csv file. It uses a .NET streamreader and is extremly fast.

## MergeHashtable

This module merges two Hashtables into one. It is able to handle nested structures like hashtables, arrays and PSCustomObjects. 

## MergePSCustomObject

This module merges PSCustomObjects into one. It is able to handle nested structures like hashtables, arrays and PSCustomObjects.

## SyncExtractOptions

This script is used to switch off or switch on some data sources in FastStats Designer to allow a build with only a few tables (like customer data)
and then later do a bigger build with customer and transactional data.

This example just changes the behaviour of the extract options and saves it in the same xml

```PowerShell
SyncExtractOptions -DesignFile "C:\Apteco\Build\20220714\designs\20220714.xml" -Include "Bookings", "People"
```



## WriteLog

This script allows to write log files pretty easy without any fuzz. It retries the write commands if parallel processes want to write into the same logfile.

Execute commands like

```PowerShell
Write-Log -message "Hello World"
Write-Log -message "Hello World" -severity ([LogSeverity]::ERROR)
"Hello World" | Write-Log
```

Then the logfile getting written looks like

```
20220217134552	a6f3eda5-1b50-4841-861e-010174784e8c	INFO	This is a general information
20220217134617	a6f3eda5-1b50-4841-861e-010174784e8c	ERROR	Note! This is an error
20220217134618	a6f3eda5-1b50-4841-861e-010174784e8c	VERBOSE	This is the verbose/debug information
20220217134619	a6f3eda5-1b50-4841-861e-010174784e8c	WARNING	And please look at this warning

```

separated by tabs.

Click on the folder for more information.

